<!DOCTYPE html>
<html lang="da-dk">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Simpel og lynhurtig ordfrekvensanalyse i nushell</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">

    <meta name="description" content="">



    <meta name="generator" content="Hugo 0.104.2" />
    
    
      <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
    

    
    
      <link href="/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    
      <link rel="stylesheet" href="/css/custom.css">
    

    
      
    

    <meta property="og:title" content="Simpel og lynhurtig ordfrekvensanalyse i Nushell" />
<meta property="og:description" content="En shell der egner sig godt til dataanalyse, er Nushell .
Den egner sig også godt til databaseret tekstanalyse, eller kvantitativ tekstanalyse.
Her et hurtigt eksempel på hvad Nushell kan.
Jeg har en tekst i filen livsfarlige-konspirationsteorier.da.md.
Antal linjer, ord og anslag i den tekst kan jeg få sådan her:
open livsfarlige-konspirationsteorier.da.md | size så giver nushell svaret
╭───────────┬──────╮ │ lines │ 51 │ │ words │ 616 │ │ bytes │ 3790 │ │ chars │ 3713 │ │ graphemes │ 3713 │ ╰───────────┴──────╯ Et hurtigt overblik over sætnings- og afsnitslængde fås som følger" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.kiils.dk/erfaring/nlp/nushell/" />






 




<meta property="og:image" content="/images/canvas_huf5a4a47d272c9e72b490e7eba58c5b9b_363_filter_16834432579830708467.png" /><meta property="article:section" content="erfaring" />
<meta property="article:published_time" content="2022-11-08T09:47:02+01:00" />
<meta property="article:modified_time" content="2022-11-08T09:47:02+01:00" /><meta property="og:site_name" content="Kiils" />

<meta itemprop="name" content="Simpel og lynhurtig ordfrekvensanalyse i Nushell">
<meta itemprop="description" content="En shell der egner sig godt til dataanalyse, er Nushell .
Den egner sig også godt til databaseret tekstanalyse, eller kvantitativ tekstanalyse.
Her et hurtigt eksempel på hvad Nushell kan.
Jeg har en tekst i filen livsfarlige-konspirationsteorier.da.md.
Antal linjer, ord og anslag i den tekst kan jeg få sådan her:
open livsfarlige-konspirationsteorier.da.md | size så giver nushell svaret
╭───────────┬──────╮ │ lines │ 51 │ │ words │ 616 │ │ bytes │ 3790 │ │ chars │ 3713 │ │ graphemes │ 3713 │ ╰───────────┴──────╯ Et hurtigt overblik over sætnings- og afsnitslængde fås som følger"><meta itemprop="datePublished" content="2022-11-08T09:47:02+01:00" />
<meta itemprop="dateModified" content="2022-11-08T09:47:02+01:00" />
<meta itemprop="wordCount" content="1164">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Simpel og lynhurtig ordfrekvensanalyse i Nushell"/>
<meta name="twitter:description" content="En shell der egner sig godt til dataanalyse, er Nushell .
Den egner sig også godt til databaseret tekstanalyse, eller kvantitativ tekstanalyse.
Her et hurtigt eksempel på hvad Nushell kan.
Jeg har en tekst i filen livsfarlige-konspirationsteorier.da.md.
Antal linjer, ord og anslag i den tekst kan jeg få sådan her:
open livsfarlige-konspirationsteorier.da.md | size så giver nushell svaret
╭───────────┬──────╮ │ lines │ 51 │ │ words │ 616 │ │ bytes │ 3790 │ │ chars │ 3713 │ │ graphemes │ 3713 │ ╰───────────┴──────╯ Et hurtigt overblik over sætnings- og afsnitslængde fås som følger"/>

      
    
  </head>

  <body class="ma0 avenir bg-near-white production">

    
   
  

  <header class="pa3 bg-near-black">

      




<nav class="w-100" role="navigation">


  <div class="fl w-third pa2 " id="menuToggle">

    
    <input type="checkbox" />

    
    <span></span>
    <span></span>
    <span></span>

    






    
      <ul id="menu" class="shadow-5">
        

          <a class="hover-white no-underline white-90" href="/" title="Forside page">
                    <li class="">
            Forside
                    </li>
          </a>

        

          <a class="hover-white no-underline white-90" href="/ydelse/" title="Ydelser page">
                    <li class="">
            Ydelser
                    </li>
          </a>

        

          <a class="hover-white no-underline white-90" href="/erfaring/" title="Erfaring page">
                    <li class="">
            Erfaring
                    </li>
          </a>

        

          <a class="hover-white no-underline white-90" href="/kontakt/" title="Kontakt page">
                    <li class="">
            Kontakt
                    </li>
          </a>

        

          <a class="hover-white no-underline white-90" href="/kunde/" title="Kunder page">
                    <li class="">
            Kunder
                    </li>
          </a>

        

          <a class="hover-white no-underline white-90" href="/priser/" title="Priser page">
                    <li class="">
            Priser
                    </li>
          </a>

        
      </ul>
    


  </div>
  <div class="fl w-third pa2 tc">
  <a href="https://www.kiils.dk/" class="p0 bw3 lh-solid f1 fw5 hover-white no-underline white">
    Kiils
  </a>
  <div class="white f6">Vær så venlig</div>
  </div>
  <div class="fl w-third pa2 ">
   <div class="fr">
    <a href="/search" class="fr f2 fw2 hover-white lh-solid no-underline white-90">
    ⌕
    </a>
    

   </div>
  </div>

</nav>


  </header>



    <main class="pa3 w-100 w-90-l mw8 center production" role="main">
      
  
  <article class="flex-l flex-wrap justify-between pa4-l">


</div>

    <header class="mt4 w-100">
      <div class="f5 b helvetica tc ttu tracked">
        <a class="link" href="/erfaring/">Erfaring</a>
  
</div>
      <h1 class="f2 f1-l center measure-narrow athelas tc mb4 mt4">Simpel og lynhurtig ordfrekvensanalyse i Nushell</h1>
      <div class="f4 mid-gray center tc tracked link  ">Af
  

     <a href="/skribenter/lennart-kiil" class="link mid-gray fw6" rel="author">
       Lennart kiil</a>

  
</div>
      <hr class="ml0 mt4 mb2 mw-100 bb b--mid-gray">
      <div>
      
      <time class="f7 dib tracked" datetime="2022-11-08T09:47:02&#43;01:00">08/11/2022</time>
      
      
        <span class="f7 dib tracked"> - 6 minutter </span>
        <span class="f7 dib tracked"> - 1164 ord</span>
      
      </div>


    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>En shell der egner sig godt til dataanalyse, er <a href="https://www.nushell.sh/" target="_blank">Nushell</a>
.</p>
<p>Den egner sig også godt til databaseret tekstanalyse, eller kvantitativ tekstanalyse.</p>
<p>Her et hurtigt eksempel på hvad Nushell kan.</p>
<p>Jeg har en tekst i filen <code>livsfarlige-konspirationsteorier.da.md</code>.</p>
<p>Antal linjer, ord og anslag i den tekst kan jeg få sådan her:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | size
</code></pre><p>så giver nushell svaret</p>
<pre tabindex="0"><code>╭───────────┬──────╮
│ lines     │ 51   │
│ words     │ 616  │
│ bytes     │ 3790 │
│ chars     │ 3713 │
│ graphemes │ 3713 │
╰───────────┴──────╯
</code></pre><p>Et hurtigt overblik over sætnings- og afsnitslængde fås som følger</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | lines
</code></pre><pre tabindex="0"><code>╭────┬──────────────────────────────────────────────────────────────────────────────────────────────╮
│  0 │ Nekrolog for en konspirationsteoretiker - leger du også med ilden?                           │
│  1 │                                                                                              │
│  2 │ Det starter ofte uskyldigt.                                                                  │
│  3 │                                                                                              │

...

│ 46 │ Hvil i fred.                                                                                 │
│ 47 │                                                                                              │
│ 48 │                                                                                              │
│ 49 │                                                                                              │
│ 50 │                                                                                              │
╰────┴──────────────────────────────────────────────────────────────────────────────────────────────╯
</code></pre><p>Tokenisering af tekstfilen er så nemt som:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | split words
</code></pre><p>der giver</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────╮
│   0 │ Nekrolog                │
│   1 │ for                     │
│   2 │ en                      │
│   3 │ konspirationsteoretiker │
│   4 │ leger                   │
│   5 │ du                      │
│   6 │ også                    │
│   7 │ med                     │
│   8 │ ilden                   │
│   9 │ Det                     │
│  10 │ starter                 │
</code></pre><p>Hyppigheden af hvert ord (ordfrekvensanalyse) findes ved:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | split words | uniq --count
</code></pre><p>der giver</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────┬───────╮
│   # │          value          │ count │
├─────┼─────────────────────────┼───────┤
│   0 │ Nekrolog                │     1 │
│   1 │ for                     │     7 │
│   2 │ en                      │    20 │
│   3 │ konspirationsteoretiker │     1 │
│   4 │ leger                   │     1 │
│   5 │ du                      │    13 │
</code></pre><p>Og så sortere på den nye kolonne som hedder count:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | split words | uniq --count | sort-by count --reverse
</code></pre><p>der videre giver</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────┬───────╮
│   # │          value          │ count │
├─────┼─────────────────────────┼───────┤
│   0 │ at                      │    21 │
│   1 │ en                      │    20 │
│   2 │ i                       │    19 │
│   3 │ som                     │    15 │
│   4 │ er                      │    15 │
│   5 │ og                      │    15 │
│   6 │ af                      │    14 │
│   7 │ du                      │    13 │
│   8 │ det                     │    10 │
│   9 │ dig                     │     9 │
│  10 │ ikke                    │     9 │
│  11 │ jeres                   │     8 │
│  12 │ med                     │     8 │
│  13 │ den                     │     7 │
</code></pre><p>Her er tydeligvis brug for at bortsortere stopwords. Men det skulle nok have været gjort inden vi begyndte at tælle antal og sortere på hyppigheden af dem.</p>
<p>Inden vi går tilbage, så lad os først tage en helt almindelig fil med et stopord på hver linje og lave den til en tabel i Nushell med kolonnenavn stopord.</p>
<pre tabindex="0"><code>open stopord.txt | lines | wrap stopord
</code></pre><p>giver</p>
<pre tabindex="0"><code>╭─────┬────────────╮
│   # │  stopord   │
├─────┼────────────┤
│   0 │ ad         │
│   1 │ af         │
│   2 │ aldrig     │
│   3 │ alene      │
│   4 │ alle       │
│   5 │ allerede   │
│   6 │ alligevel  │
│   7 │ alt        │
│   8 │ altid      │
...
</code></pre><p>Vi &ldquo;gemmer&rdquo; tabellen i en variabel:</p>
<pre tabindex="0"><code>let stopwords = ( open stopord.txt | lines | wrap stopord )
</code></pre><p>Hvis vi nu går tilbage til vores tekst on konspirationers farlighed og deler den op i ord også med kolonnenavn <code>ord</code>:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | split words | wrap ord
</code></pre><p>får vi</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────╮
│   # │           ord           │
├─────┼─────────────────────────┤
│   0 │ Nekrolog                │
│   1 │ for                     │
│   2 │ en                      │
│   3 │ konspirationsteoretiker │
│   4 │ leger                   │
│   5 │ du                      │
│   6 │ også                    │
│   7 │ med                     │
│   8 │ ilden                   │
│   9 │ Det                     │
...
</code></pre><p>Den tabel skal nu have fjernet alle ord som også findes i tabellen over stopord.</p>
<p>Det kaldes teknisk set en &ldquo;antijoin&rdquo;</p>
<p>Desværre kan Nushell endnu ikke lave en rigtig antijoin på tabeller (men det kan den på dataframes og det vender jeg tilbage til i næste artikel om nushell).</p>
<p>Så i stedet gør vi sådan her:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | split words | wrap ord | where ord in $stopwords.stopord == false
</code></pre><p>og det giver så</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────╮
│   # │           ord           │
├─────┼─────────────────────────┤
│   0 │ Nekrolog                │
│   1 │ konspirationsteoretiker │
│   2 │ leger                   │
│   3 │ ilden                   │
│   4 │ Det                     │
│   5 │ starter                 │
│   6 │ ofte                    │
│   7 │ uskyldigt               │
│   8 │ Du                      │
│   9 │ opdager                 │
│  10 │ mainstream              │
│  11 │ medierne                │
│  12 │ lyver                   │
...
</code></pre><p>Som man ser, er stopwords fjernet, men ikke dem som er skrevet med stort.</p>
<p>Så lad os &ldquo;downcase&rdquo; alle ord i teksten først med <code>str downcase</code> lige efter filnavnet:</p>
<pre tabindex="0"><code>open livsfarlige-konspirationsteorier.da.md | str downcase | split words | wrap ord | where ord in $stopwords.stopord == false
</code></pre><p>Det giver så</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────╮
│   # │           ord           │
├─────┼─────────────────────────┤
│   0 │ nekrolog                │
│   1 │ konspirationsteoretiker │
│   2 │ leger                   │
│   3 │ ilden                   │
│   4 │ starter                 │
│   5 │ ofte                    │
│   6 │ uskyldigt               │
│   7 │ opdager                 │
│   8 │ mainstream              │
│   9 │ medierne                │
│  10 │ lyver                   │
│  11 │ lyver                   │
│  12 │ ligefrem                │
...
</code></pre><p>Lad os gemme den rensede og &ldquo;downcasede&rdquo; tekst som variablen <code>tidy</code>.</p>
<pre tabindex="0"><code>let tidy = ( open livsfarlige-konspirationsteorier.da.md | str downcase | split words | wrap ord | where ord in $stopwords.stopord == false )
</code></pre><p>Og hvis vi så tæller og sorterer igen</p>
<pre tabindex="0"><code>$tidy.ord | uniq --count | sort-by count --reverse
</code></pre><p>så får vi</p>
<pre tabindex="0"><code>╭─────┬─────────────────────────┬───────╮
│   # │          value          │ count │
├─────┼─────────────────────────┼───────┤
│   0 │ verden                  │     5 │
│   1 │ dag                     │     4 │
│   2 │ verdensopfattelse       │     4 │
│   3 │ mainstream              │     4 │
│   4 │ frelser                 │     3 │
│   5 │ hele                    │     3 │
│   6 │ alternative             │     3 │
│   7 │ begynder                │     3 │
│   8 │ magtfuld                │     2 │
│   9 │ pludselig               │     2 │
│  10 │ tager                   │     2 │
│  11 │ står                    │     2 │
│  12 │ tiden                   │     2 │
</code></pre><p>som giver en ide om hvad teksten handler om.</p>
<p>Desværre tager processen</p>
<pre tabindex="0"><code>benchmark {                                                                                           11/08/2022 11:00:49 
::: let stopwords = ( open stopord.txt | lines | wrap stopord )
::: let tidy = ( open livsfarlige-konspirationsteorier.da.md | str downcase | split words | wrap ord | where ord in $stopwords.stopord == false )
::: $tidy.ord | uniq --count | sort-by count --reverse }
</code></pre><p>over en tiendedel af et sekund:</p>
<pre tabindex="0"><code>145ms 516µs 353ns
</code></pre><p>Næste gang ser jeg på om det kan gøres både mere elegant og hurtigere med dataframes i Nushell.</p>
<ul class="pa0">
  
</ul>
<ul class="pa0">
  
</ul>
<div class="mt6">
        
      </div>

      
      
      
      
      
      
      
      
      
      
      
      


    </section>

    <section>
      
    </section>






    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="pa3 bg-near-black bottom-0 w-100" role="contentinfo">
 <div class="pa3 pa5-l">
  <div class="flex justify-between">
  <span class="f4 fw4  white-70 pv3">
    &copy; 2022 Kiils v/ <a class="hover-white  white-70 no-underline" href="https://www.folkets.dk/brugere/lennart-kiil">Lennart Kiil</a>
  </span>
    <div>






<a href="https://www.linkedin.com/company/kiils/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>





</div>
  </div>



    <ul class="list pl0 flex-column-s flex-column-m flex-l justify-between-l">
        

        
            
                <li class="f5 pv2">
                    <a href="/ydelse/" class="hover-white no-underline white-60">
                        <span>Ydelser</span>
                    </a>


                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/ydelse/research/faktatjek/" class="hover-white no-underline white-60">
                            <span>Faktatjek</span>
                        </a>
                        </li>
                      </ul>
                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/ydelse/raadgivning/indholdsstrategi/" class="hover-white no-underline white-60">
                            <span>Indholdsstrategi</span>
                        </a>
                        </li>
                      </ul>
                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/ydelse/redaktionelt/formidling/" class="hover-white no-underline white-60">
                            <span>Formidling</span>
                        </a>
                        </li>
                      </ul>
                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/ydelse/redaktionelt/korrektur/" class="hover-white no-underline white-60">
                            <span>Korrektur</span>
                        </a>
                        </li>
                      </ul>
                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/ydelse/research/skattejagt/" class="hover-white no-underline white-60">
                            <span>Skattejagt</span>
                        </a>
                        </li>
                      </ul>
                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/ydelse/redaktionelt/tekst/" class="hover-white no-underline white-60">
                            <span>Tekster</span>
                        </a>
                        </li>
                      </ul>
                    
                </li>
            
        
            
                <li class="f5 pv2">
                    <a href="/cases/" class="hover-white no-underline white-60">
                        <span>Cases</span>
                    </a>


                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/cases/coronakatastrofen/" class="hover-white no-underline white-60">
                            <span>Coronakatastrofen</span>
                        </a>
                        </li>
                      </ul>
                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/cases/folkets/" class="hover-white no-underline white-60">
                            <span>FOLKETS</span>
                        </a>
                        </li>
                      </ul>
                    
                </li>
            
        
            
                <li class="f5 pv2">
                    <a href="/domains/" class="hover-white no-underline white-60">
                        <span>Domæner</span>
                    </a>


                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/domains/folkets/" class="hover-white no-underline white-60">
                            <span>Folkets.dk</span>
                        </a>
                        </li>
                      </ul>
                    
                </li>
            
        
            
                <li class="f5 pv2">
                    <a href="/emner/" class="hover-white no-underline white-60">
                        <span>Emner</span>
                    </a>
                </li>
            
        
            
                <li class="f5 pv2">
                    <a href="/erfaring/" class="hover-white no-underline white-60">
                        <span>Erfaring</span>
                    </a>
                </li>
            
        
            
                <li class="f5 pv2">
                    <a href="/kunde/" class="hover-white no-underline white-60">
                        <span>Kunder</span>
                    </a>
                </li>
            
        
            
                <li class="f5 pv2">
                    <a href="/tools/" class="hover-white no-underline white-60">
                        <span>Tools</span>
                    </a>


                    
                        <ul class="list pl1">
                        <li class="f7">
                        <a href="/tools/drupal-8/" class="hover-white no-underline white-60">
                            <span>Drupal 8</span>
                        </a>
                        </li>
                      </ul>
                    
                </li>
            
        

    </ul>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body></html>
